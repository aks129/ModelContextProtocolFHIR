{% extends "base.html" %}

{% block title %}MCP FHIR Server - API Documentation{% endblock %}

{% block content %}
<div class="card shadow-sm mb-4">
    <div class="card-header bg-primary text-white">
        <h1 class="card-title mb-0">
            <i class="fas fa-book me-2"></i>API Documentation
        </h1>
    </div>
    <div class="card-body">
        <p class="lead">
            This documentation describes the API endpoints available in the MCP FHIR Server.
        </p>
        
        <div class="alert alert-info" role="alert">
            <h4 class="alert-heading"><i class="fas fa-info-circle me-2"></i>Base URL</h4>
            <p class="mb-0">All API endpoints are relative to the server's base URL.</p>
        </div>
        
        <h2 class="mt-4">API Endpoints</h2>
        
        <!-- Status Endpoint -->
        <div class="card mb-4">
            <div class="card-header bg-secondary">
                <h3 class="h5 mb-0">Server Status</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 fw-bold">Endpoint:</div>
                    <div class="col-md-9"><code>/api/status</code></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Method:</div>
                    <div class="col-md-9"><code>GET</code></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Description:</div>
                    <div class="col-md-9">Returns the status of the MCP server and FHIR server connection.</div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Response:</div>
                    <div class="col-md-9">
<pre class="bg-dark text-light p-3 rounded"><code>{
  "mcp_server": "running",
  "fhir_server_configured": true,
  "fhir_server_connection": "connected"
}</code></pre>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Metadata Endpoint -->
        <div class="card mb-4">
            <div class="card-header bg-secondary">
                <h3 class="h5 mb-0">FHIR Server Metadata</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 fw-bold">Endpoint:</div>
                    <div class="col-md-9"><code>/api/fhir/metadata</code></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Method:</div>
                    <div class="col-md-9"><code>GET</code></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Description:</div>
                    <div class="col-md-9">Returns the FHIR server's capability statement (metadata).</div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Response:</div>
                    <div class="col-md-9">
                        <p>Returns the FHIR server's capability statement in JSON format.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Resource Read Endpoint -->
        <div class="card mb-4">
            <div class="card-header bg-secondary">
                <h3 class="h5 mb-0">Read Resource</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 fw-bold">Endpoint:</div>
                    <div class="col-md-9"><code>/api/fhir/resource/{resource_type}/{resource_id}</code></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Method:</div>
                    <div class="col-md-9"><code>GET</code></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Path Parameters:</div>
                    <div class="col-md-9">
                        <ul>
                            <li><code>resource_type</code>: The FHIR resource type (e.g., Patient, Observation)</li>
                            <li><code>resource_id</code>: The ID of the resource to retrieve</li>
                        </ul>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Description:</div>
                    <div class="col-md-9">Retrieves a specific FHIR resource by type and ID.</div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Response:</div>
                    <div class="col-md-9">
                        <p>Returns the requested FHIR resource in JSON format.</p>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Example:</div>
                    <div class="col-md-9">
                        <code>/api/fhir/resource/Patient/123</code>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Resource Search Endpoint -->
        <div class="card mb-4">
            <div class="card-header bg-secondary">
                <h3 class="h5 mb-0">Search Resources</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 fw-bold">Endpoint:</div>
                    <div class="col-md-9"><code>/api/fhir/search/{resource_type}</code></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Method:</div>
                    <div class="col-md-9"><code>GET</code></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Path Parameters:</div>
                    <div class="col-md-9">
                        <ul>
                            <li><code>resource_type</code>: The FHIR resource type to search for (e.g., Patient, Observation)</li>
                        </ul>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Query Parameters:</div>
                    <div class="col-md-9">
                        <p>Any valid FHIR search parameters for the specified resource type.</p>
                        <p>Examples:</p>
                        <ul>
                            <li><code>name=Smith</code>: Search for patients with the name "Smith"</li>
                            <li><code>birthdate=1970-01-01</code>: Search for patients born on January 1, 1970</li>
                            <li><code>_count=10</code>: Limit results to 10 items</li>
                        </ul>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Description:</div>
                    <div class="col-md-9">Searches for FHIR resources of a specific type using query parameters.</div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Response:</div>
                    <div class="col-md-9">
                        <p>Returns a FHIR Bundle containing the search results in JSON format.</p>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-3 fw-bold">Example:</div>
                    <div class="col-md-9">
                        <code>/api/fhir/search/Patient?name=Smith&gender=male</code>
                    </div>
                </div>
            </div>
        </div>
        
        <h2 class="mt-4">Error Handling</h2>
        <div class="card mb-4">
            <div class="card-body">
                <p>All API endpoints return appropriate HTTP status codes:</p>
                <ul>
                    <li><code>200 OK</code>: Request successful</li>
                    <li><code>400 Bad Request</code>: Invalid request parameters</li>
                    <li><code>404 Not Found</code>: Resource not found</li>
                    <li><code>500 Internal Server Error</code>: Server error</li>
                </ul>
                <p>Error responses include a JSON object with an error message:</p>
<pre class="bg-dark text-light p-3 rounded"><code>{
  "error": "Description of the error"
}</code></pre>
            </div>
        </div>
    </div>
</div>
{% endblock %}
